<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product List</title>

    <script type="text/javascript" src="ajax.js"></script>
    <script>
        function confirmDel() {
            return confirm("Do you want to delete this product?");
        }
    </script>
</head>

<body>
<%- include("home.ejs") %>

<div class="container p-5">

   
    <div class="form-group">
        <input type="text"
               class="form-control"
               placeholder="Search product"
               onkeyup="searchProd(this.value)">
    </div>

   
    <table class="table table-striped mt-3">
        <thead class="thead-dark">
        <tr>
            <th>SR NO</th>
            <th>PROD NAME</th>
            <th>CATEGORY</th>
            <th>PRICE</th>
            <th>QTY</th>
            <th>DELETE</th>
            <th>UPDATE</th>
        </tr>
        </thead>

        <tbody id="tblBody">
        <% if (prodList.length > 0) { %>
            <% prodList.forEach((row, index) => { %>
                <tr>
                    <td>
                        <%= (currentPage - 1) * 10 + index + 1 %>
                    </td>
                    <td><%= row.pname %></td>
                    <td><%= row.cname %></td>
                    <td><%= row.price %></td>
                    <td><%= row.stock %></td>

                    <td>
                        <a href="/deleteprod?id=<%= row.pid %>"
                           onclick="return confirmDel()">
                           DELETE
                        </a>
                    </td>

                    <td>
                        <a href="/updateprod
                            ?pid=<%= row.pid %>
                            &pname=<%= row.pname %>
                            &price=<%= row.price %>
                            &cid=<%= row.cid %>
                            &stock=<%= row.stock %>">
                            UPDATE
                        </a>
                    </td>
                </tr>
            <% }) %>
        <% } else { %>
            <tr>
                <td colspan="7">No Data Found</td>
            </tr>
        <% } %>
        </tbody>
    </table>

   
    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">

            <% if (currentPage > 1) { %>
                <li class="page-item">
                    <a class="page-link"
                       href="/viewprod?page=<%= currentPage - 1 %>">
                       Previous
                    </a>
                </li>
            <% } %>

            <% for (let i = 1; i <= totalPages; i++) { %>
                <li class="page-item <%= i === currentPage ? 'active' : '' %>">
                    <a class="page-link" href="/viewprod?page=<%= i %>">
                        <%= i %>
                    </a>
                </li>
            <% } %>

            <% if (currentPage < totalPages) { %>
                <li class="page-item">
                    <a class="page-link"
                       href="/viewprod?page=<%= currentPage + 1 %>">
                       Next
                    </a>
                </li>
            <% } %>

        </ul>
    </nav>

</div>
</body>
</html>
